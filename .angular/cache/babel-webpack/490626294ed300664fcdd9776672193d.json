{"ast":null,"code":"import { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/Services/Security/security-roles.service\";\nimport * as i2 from \"src/app/Services/Global/notifications.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/progress-spinner\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/dialog\";\nimport * as i7 from \"@angular/material/button\";\nimport * as i8 from \"@angular/material/expansion\";\nimport * as i9 from \"@angular/material/checkbox\";\nimport * as i10 from \"@angular/material/icon\";\nimport * as i11 from \"@angular/material/list\";\nfunction SecurityRolesUIComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵelement(1, \"mat-spinner\", 4);\n    i0.ɵɵelementStart(2, \"span\", 5);\n    i0.ɵɵtext(3, \"Loading...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SecurityRolesUIComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.error);\n  }\n}\nfunction SecurityRolesUIComponent_form_2_div_1_div_4_mat_icon_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r7 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r7.expanded ? \"expand_more\" : \"expand_less\", \" \");\n  }\n}\nfunction SecurityRolesUIComponent_form_2_div_1_div_4_div_6_mat_list_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mat-list-item\");\n    i0.ɵɵelementStart(1, \"mat-checkbox\", 20);\n    i0.ɵɵlistener(\"change\", function SecurityRolesUIComponent_form_2_div_1_div_4_div_6_mat_list_item_2_Template_mat_checkbox_change_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r15);\n      const submenu_r12 = restoredCtx.$implicit;\n      const item_r7 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(3);\n      return ctx_r13.onCheckboxChange2(item_r7, submenu_r12, $event);\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const submenu_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"checked\", submenu_r12.access);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", submenu_r12.description, \" \");\n  }\n}\nfunction SecurityRolesUIComponent_form_2_div_1_div_4_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"mat-list\");\n    i0.ɵɵtemplate(2, SecurityRolesUIComponent_form_2_div_1_div_4_div_6_mat_list_item_2_Template, 3, 2, \"mat-list-item\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r7 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", item_r7.submenu);\n  }\n}\nfunction SecurityRolesUIComponent_form_2_div_1_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵelementStart(1, \"mat-expansion-panel\", 16);\n    i0.ɵɵlistener(\"opened\", function SecurityRolesUIComponent_form_2_div_1_div_4_Template_mat_expansion_panel_opened_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const item_r7 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext(3);\n      return ctx_r17.toggleSubMenu(item_r7);\n    })(\"closed\", function SecurityRolesUIComponent_form_2_div_1_div_4_Template_mat_expansion_panel_closed_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const item_r7 = restoredCtx.$implicit;\n      const ctx_r19 = i0.ɵɵnextContext(3);\n      return ctx_r19.toggleSubMenu(item_r7);\n    });\n    i0.ɵɵelementStart(2, \"mat-expansion-panel-header\");\n    i0.ɵɵelementStart(3, \"mat-checkbox\", 17);\n    i0.ɵɵlistener(\"change\", function SecurityRolesUIComponent_form_2_div_1_div_4_Template_mat_checkbox_change_3_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const item_r7 = restoredCtx.$implicit;\n      const ctx_r20 = i0.ɵɵnextContext(3);\n      return ctx_r20.onCheckboxChange2(item_r7, item_r7.submenu, $event);\n    })(\"click\", function SecurityRolesUIComponent_form_2_div_1_div_4_Template_mat_checkbox_click_3_listener($event) {\n      return $event.stopPropagation();\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, SecurityRolesUIComponent_form_2_div_1_div_4_mat_icon_5_Template, 2, 1, \"mat-icon\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, SecurityRolesUIComponent_form_2_div_1_div_4_div_6_Template, 3, 1, \"div\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r7 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"checked\", item_r7.access);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r7.description, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (item_r7.submenu == null ? null : item_r7.submenu.length) > 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r7.expanded);\n  }\n}\nfunction SecurityRolesUIComponent_form_2_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵelementStart(1, \"h4\", 13);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"titlecase\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, SecurityRolesUIComponent_form_2_div_1_div_4_Template, 7, 4, \"div\", 14);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const section_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, section_r5.desc_code));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", section_r5.datas);\n  }\n}\nfunction SecurityRolesUIComponent_form_2_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1, \"No data available\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SecurityRolesUIComponent_form_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r23 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 7);\n    i0.ɵɵlistener(\"ngSubmit\", function SecurityRolesUIComponent_form_2_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r23);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return ctx_r22.submitData();\n    });\n    i0.ɵɵtemplate(1, SecurityRolesUIComponent_form_2_div_1_Template, 5, 4, \"div\", 8);\n    i0.ɵɵtemplate(2, SecurityRolesUIComponent_form_2_div_2_Template, 2, 0, \"div\", 9);\n    i0.ɵɵelementStart(3, \"div\", 10);\n    i0.ɵɵelementStart(4, \"button\", 11);\n    i0.ɵɵtext(5, \"Update\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.securityRoles);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.securityRoles.length === 0);\n  }\n}\nexport let SecurityRolesUIComponent = /*#__PURE__*/(() => {\n  class SecurityRolesUIComponent {\n    constructor(securityService, notificationService, data) {\n      this.securityService = securityService;\n      this.notificationService = notificationService;\n      this.data = data;\n      this.isLoading = false;\n      this.securityRoles = [];\n      this.loading = false;\n      this.error = null;\n      this.selectedMenus = [];\n      this.role_code = data.rolecode;\n    }\n    ngOnInit() {\n      this.getSecurityRoles(this.role_code);\n    }\n    closeLoading() {\n      this.loading = false;\n    }\n    getSecurityRoles(rolecode) {\n      this.loading = true;\n      this.securityService.getSecurityRolesByDesc_Code(rolecode).subscribe(datas => {\n        this.securityRoles = datas;\n        console.log(this.securityRoles);\n        this.loading = false;\n      }, error => {\n        console.error('Error fetching security roles:', error);\n        this.error = 'Failed to load security roles';\n        this.loading = false;\n      });\n    }\n    toggleSubMenu(menu) {\n      menu.expanded = !menu.expanded;\n    }\n    onCheckboxChange2(item, submenu, event) {\n      var _a;\n      // Initialize selectedMenus if not already defined\n      (_a = this.selectedMenus) !== null && _a !== void 0 ? _a : this.selectedMenus = [];\n      const submenusId = submenu === null || submenu === void 0 ? void 0 : submenu.submenus_id;\n      const menuIndex = this.selectedMenus.findIndex(menu => menu.menus_id === item.menus_id);\n      if (event.checked) {\n        // Add new menu if it doesn't exist\n        if (menuIndex === -1) {\n          this.selectedMenus.push({\n            rolecode: this.role_code,\n            menus_id: item.menus_id,\n            lines: submenusId ? [{\n              submenus_id: submenusId\n            }] : []\n          });\n        } else if (submenusId) {\n          // Update existing menu with new submenus_id if not already present\n          const menu = this.selectedMenus[menuIndex];\n          if (!menu.lines.some(line => line.submenus_id === submenusId)) {\n            menu.lines.push({\n              submenus_id: submenusId\n            });\n          }\n        }\n      } else {\n        // Remove submenus_id if unchecked\n        if (menuIndex !== -1) {\n          const menu = this.selectedMenus[menuIndex];\n          menu.lines = menu.lines.filter(line => line.submenus_id !== submenusId);\n          // Remove menu entry if lines array is empty\n          if (menu.lines.length === 0) {\n            this.selectedMenus.splice(menuIndex, 1);\n          }\n        }\n      }\n      console.log(\"selectedMenus:\", this.selectedMenus);\n    }\n    submitData() {\n      console.log(\"Submitted Data:\", this.selectedMenus);\n      const header = {\n        header: this.selectedMenus\n      };\n      //console.log(header)\n      this.securityService.submitData(header).subscribe({\n        next: res => {\n          if (res.success) {\n            this.loading = true;\n            this.notificationService.toastrSuccess(res.message);\n            this.loading = false;\n          } else {\n            this.notificationService.toastrError(res.message);\n            this.loading = false;\n          }\n        },\n        error: err => {\n          this.loading = false;\n          this.error = 'There was an error submitting the form. Please try again.';\n          this.notificationService.toastrError(this.error);\n        }\n      });\n    }\n  }\n  SecurityRolesUIComponent.ɵfac = function SecurityRolesUIComponent_Factory(t) {\n    return new (t || SecurityRolesUIComponent)(i0.ɵɵdirectiveInject(i1.SecurityRolesService), i0.ɵɵdirectiveInject(i2.NotificationsService), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA));\n  };\n  SecurityRolesUIComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SecurityRolesUIComponent,\n    selectors: [[\"app-security-roles-ui\"]],\n    decls: 3,\n    vars: 3,\n    consts: [[\"class\", \"d-flex justify-content-center align-items-center my-4\", 4, \"ngIf\"], [\"class\", \"alert alert-danger text-center\", 4, \"ngIf\"], [3, \"ngSubmit\", 4, \"ngIf\"], [1, \"d-flex\", \"justify-content-center\", \"align-items-center\", \"my-4\"], [\"diameter\", \"40\"], [1, \"ml-3\"], [1, \"alert\", \"alert-danger\", \"text-center\"], [3, \"ngSubmit\"], [\"class\", \"mb-4\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"alert alert-info text-center\", 4, \"ngIf\"], [\"mat-dialog-actions\", \"\", \"align\", \"end\"], [\"type\", \"submit\", \"mat-raised-button\", \"\", \"color\", \"primary\"], [1, \"mb-4\"], [1, \"text-primary\"], [\"class\", \"mb-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"mb-3\"], [3, \"opened\", \"closed\"], [3, \"checked\", \"change\", \"click\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"checked\", \"change\"], [1, \"alert\", \"alert-info\", \"text-center\"]],\n    template: function SecurityRolesUIComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, SecurityRolesUIComponent_div_0_Template, 4, 0, \"div\", 0);\n        i0.ɵɵtemplate(1, SecurityRolesUIComponent_div_1_Template, 2, 1, \"div\", 1);\n        i0.ɵɵtemplate(2, SecurityRolesUIComponent_form_2_Template, 6, 2, \"form\", 2);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.loading);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.error);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error);\n      }\n    },\n    directives: [i3.NgIf, i4.MatProgressSpinner, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.NgForm, i3.NgForOf, i6.MatDialogActions, i7.MatButton, i8.MatExpansionPanel, i8.MatExpansionPanelHeader, i9.MatCheckbox, i10.MatIcon, i11.MatList, i11.MatListItem],\n    pipes: [i3.TitleCasePipe],\n    styles: [\".mat-checkbox[_ngcontent-%COMP%]   .mat-checkbox-label[_ngcontent-%COMP%]{padding-left:10px}.close-button[_ngcontent-%COMP%]{position:absolute;top:18px;right:8px}.mat-list-item[_ngcontent-%COMP%]{padding-left:40px}.mat-expansion-panel-header[_ngcontent-%COMP%]{background-color:#f1f1f1}.mat-card[_ngcontent-%COMP%]{margin-top:5px}.submenu-container[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;padding-right:10px}.mat-checkbox[_ngcontent-%COMP%]{display:block}.mat-icon[_ngcontent-%COMP%]{font-size:18px;margin-left:8px}.submenu-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.submenu-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#a9a9a9;border-radius:10px}.submenu-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#d3d3d3}.d-flex[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:50vh}.mat-spinner[_ngcontent-%COMP%]{width:40px;height:40px}.ml-2[_ngcontent-%COMP%]{margin-left:10px}.close-button[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background-color:transparent;border:none;padding:0;cursor:pointer}.close-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;color:#fff}@media (max-width: 600px){.mat-spinner[_ngcontent-%COMP%]{width:40px;height:40px}}@media (min-width: 1200px){.mat-spinner[_ngcontent-%COMP%]{width:60px;height:60px}}@media (max-width: 600px){.submenu-container[_ngcontent-%COMP%]{max-height:200px}.mat-expansion-panel-header[_ngcontent-%COMP%]{padding:8px 16px}.mat-checkbox[_ngcontent-%COMP%]{font-size:14px}.mat-icon[_ngcontent-%COMP%]{font-size:16px}.mat-card[_ngcontent-%COMP%]{margin-top:10px}}@media (min-width: 601px){.submenu-container[_ngcontent-%COMP%]{max-height:400px}.mat-checkbox[_ngcontent-%COMP%]{font-size:16px}.mat-icon[_ngcontent-%COMP%]{font-size:18px}}\"]\n  });\n  return SecurityRolesUIComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}