{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/Services/Images/image.service\";\nimport * as i2 from \"src/app/Services/Global/notifications.service\";\nfunction ImageDialogComponent_div_3_div_2_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"img\", 9);\n    i0.ɵɵlistener(\"click\", function ImageDialogComponent_div_3_div_2_img_1_Template_img_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const image_r5 = i0.ɵɵnextContext().$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.openPreview(image_r5.file_path);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const image_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", image_r5.file_path, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ImageDialogComponent_div_3_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtemplate(1, ImageDialogComponent_div_3_div_2_img_1_Template, 1, 1, \"img\", 7);\n    i0.ɵɵelementStart(2, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function ImageDialogComponent_div_3_div_2_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const image_r5 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return ctx_r11.delete(image_r5.transCode);\n    });\n    i0.ɵɵelementStart(3, \"mat-icon\");\n    i0.ɵɵtext(4, \"delete\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const image_r5 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", image_r5.file_path);\n  }\n}\nfunction ImageDialogComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"div\", 4);\n    i0.ɵɵtemplate(2, ImageDialogComponent_div_3_div_2_Template, 5, 1, \"div\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.images);\n  }\n}\nfunction ImageDialogComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"No images uploaded yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ImageDialogComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵlistener(\"click\", function ImageDialogComponent_div_6_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.closePreview();\n    });\n    i0.ɵɵelementStart(1, \"div\", 11);\n    i0.ɵɵelementStart(2, \"img\", 12);\n    i0.ɵɵlistener(\"click\", function ImageDialogComponent_div_6_Template_img_click_2_listener($event) {\n      return $event.stopPropagation();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", ctx_r3.selectedImage, i0.ɵɵsanitizeUrl);\n  }\n}\nexport let ImageDialogComponent = /*#__PURE__*/(() => {\n  class ImageDialogComponent {\n    constructor(imageService, notificationsService) {\n      this.imageService = imageService;\n      this.notificationsService = notificationsService;\n      this.images = []; // Store images from API  images: Image[] = [];\n      this.images2 = [];\n      this.selectedImage = null; // Store selected image for popup\n      this.imageLoaded = {}; // Track which images are loaded\n      this.loading = true; // Add loading state\n      this.deleteLoading = {}; // Track loading state for each image\n    }\n    ngOnInit() {\n      this.loadImages();\n    }\n    onImageError(event) {\n      event.target.src = 'assets/default-placeholder.png'; // Set a default image\n    }\n    closePreview() {\n      this.selectedImage = null;\n    }\n    // Open image preview\n    openPreview(imageUrl) {\n      this.selectedImage = imageUrl;\n      console.log(this.selectedImage);\n    }\n    loadImages() {\n      this.imageService.getImages().subscribe({\n        next: response => {\n          console.log('API Response:', response);\n          if ((response === null || response === void 0 ? void 0 : response.success) && Array.isArray(response.images)) {\n            this.images = response.images.map(image => ({\n              id: image.id,\n              transCode: image.transCode,\n              file_path: image.url ? image.url.replace(/\\\\/g, '/') : ''\n            }));\n          } else {\n            console.warn('No images found in response or invalid format.');\n          }\n        },\n        error: error => {\n          console.error('Error fetching images:', error);\n        }\n      });\n    }\n    delete(transCode) {\n      this.notificationsService.popupWarning(transCode, \"Are you sure to delete this image?\").then(result => {\n        if (result.value) {\n          this.imageService.deleteImage(transCode).subscribe({\n            next: res => {\n              if (res.success == true) {\n                this.notificationsService.toastrSuccess(res.message);\n                this.loadImages(); // Refresh images after deletion\n              } else {\n                this.notificationsService.toastrError(res.message);\n              }\n            },\n            error: error => {\n              this.deleteLoading[transCode] = false; // Stop loading on error\n              this.notificationsService.toastrError(error.error);\n            }\n          });\n        }\n      });\n    }\n    openImage(imageUrl) {\n      this.selectedImage = imageUrl;\n    }\n  }\n  ImageDialogComponent.ɵfac = function ImageDialogComponent_Factory(t) {\n    return new (t || ImageDialogComponent)(i0.ɵɵdirectiveInject(i1.ImageService), i0.ɵɵdirectiveInject(i2.NotificationsService));\n  };\n  ImageDialogComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ImageDialogComponent,\n    selectors: [[\"app-image-dialog\"]],\n    decls: 7,\n    vars: 3,\n    consts: [[1, \"image-gallery\"], [4, \"ngIf\", \"ngIfElse\"], [\"noImages\", \"\"], [\"class\", \"overlay\", 3, \"click\", 4, \"ngIf\"], [1, \"grid\"], [\"class\", \"image-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"image-card\"], [\"alt\", \"Uploaded Image\", \"class\", \"thumbnail\", 3, \"src\", \"click\", 4, \"ngIf\"], [\"mat-icon-button\", \"\", \"color\", \"warn\", 1, \"delete-icon\", 3, \"click\"], [\"alt\", \"Uploaded Image\", 1, \"thumbnail\", 3, \"src\", \"click\"], [1, \"overlay\", 3, \"click\"], [1, \"popup\"], [1, \"full-image\", 3, \"src\", \"click\"]],\n    template: function ImageDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"h2\");\n        i0.ɵɵtext(2, \"Blog Images\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, ImageDialogComponent_div_3_Template, 3, 1, \"div\", 1);\n        i0.ɵɵtemplate(4, ImageDialogComponent_ng_template_4_Template, 2, 0, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(6, ImageDialogComponent_div_6_Template, 3, 1, \"div\", 3);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(5);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.images.length > 0)(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedImage);\n      }\n    },\n    styles: [\".image-gallery[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto;padding:5px}.grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;grid-gap:10px;gap:10px;justify-content:center;overflow-y:auto;max-height:60vh}.image-card[_ngcontent-%COMP%]{width:150px;text-align:center;padding:10px;background:#f8f8f8;border-radius:5px;box-shadow:2px 2px 10px #0000001a}.thumbnail[_ngcontent-%COMP%]{width:100%;height:auto;cursor:pointer;max-height:120px;-o-object-fit:cover;object-fit:cover}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;overflow:auto}.popup[_ngcontent-%COMP%]{max-width:90%;max-height:90%;overflow:auto;background:white;padding:20px;border-radius:10px;box-shadow:0 0 10px #fff3}.full-image[_ngcontent-%COMP%]{max-width:100%;max-height:90vh;-o-object-fit:contain;object-fit:contain;display:block;margin:auto}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px 0}.image-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.mat-spinner[_ngcontent-%COMP%]{position:absolute}.delete-icon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}\"]\n  });\n  return ImageDialogComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}